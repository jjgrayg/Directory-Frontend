<!-- CSS Styles -->
<style>
    .clickable{
        cursor: pointer;
        transition: all 0.07s ease-in-out;
    }
    .clickable:hover {
        background-color: yellow !important;
    }
    #map-area {
        position: relative;
        width: auto;
        margin-bottom: 20px;
        box-shadow: rgb(45 35 66 / 40%) 0 2px 4px, rgb(45 35 66 / 30%) 0 7px 13px -3px, #d6d6e7 0 -3px 0 inset;
    }
    div[id*='mapster_wrap'], .mapster_el {
        width: 100% !important;
        height: auto !important;
    }
    img {
        width: 100%;
    }
    .realtive-position {
        position: relative;
        width: auto;
    }
    .hover-text {
        position: absolute;
        transform: translate(-50%, -50%);
        text-align: center;
        background: #9900ff;
        color: white;
        font-family: Roboto, sans-serif;
        font-weight: bold;
        text-align: center;
        font-family: Roboto, sans-serif;
        border-radius: 25px;
        padding: 10px;
        box-shadow: rgba(127, 0, 212, 0.4) 0 2px 4px, rgba(162, 23, 255, 0.3) 0 7px 13px -3px, rgb(162, 23, 255) 0 -3px 0 inset;
    }
    .base-img {
        width: 100% !important;
        height: auto;
    }
    area {
        cursor: pointer;
    }
    area:focus {
        outline: 1px solid;
    }
    button {
        align-items: center;
        appearance: none;
        background-color: #FCFCFD;
        border-radius: 4px;
        border-width: 0;
        box-shadow: rgba(45, 35, 66, 0.4) 0 2px 4px,rgba(45, 35, 66, 0.3) 0 7px 13px -3px,#D6D6E7 0 -3px 0 inset;
        box-sizing: border-box;
        color: #36395A;
        cursor: pointer;
        display: inline-flex;
        font-family: Roboto, sans-serif;
        height: 48px;
        justify-content: center;
        line-height: 1;
        list-style: none;
        overflow: hidden;
        padding-left: 16px;
        padding-right: 16px;
        position: relative;
        text-align: left;
        text-decoration: none;
        transition: box-shadow .15s,transform .15s;
        user-select: none;
        -webkit-user-select: none;
        touch-action: manipulation;
        white-space: nowrap;
        will-change: box-shadow,transform;
        font-size: 18px;
        width: 14rem;
    }
    button.active, button:active {
        box-shadow: #D6D6E7 0 3px 7px inset;
        transform: translateY(2px);
    }
    button:hover {
        box-shadow: rgba(45, 35, 66, 0.4) 0 4px 8px, rgba(45, 35, 66, 0.3) 0 7px 13px -3px, #D6D6E7 0 -3px 0 inset;
        transform: translateY(-2px);
    }
    button:focus {
        box-shadow: #D6D6E7 0 0 0 1.5px inset, rgba(45, 35, 66, 0.4) 0 2px 4px, rgba(45, 35, 66, 0.3) 0 7px 13px -3px, #D6D6E7 0 -3px 0 inset;
    }
    .switch-buttons {
        width: 100%;
        display: flex;
        justify-content: center;
    }
    button#department {
        border-top-left-radius: 50px;
        border-bottom-left-radius: 50px;
        border-right: none;
    }
    button#office {
        border-top-right-radius: 50px;
        border-bottom-right-radius: 50px;
    }
    .switch-buttons {
        padding-bottom: 20px;
    }
    
    /*Scrollbar Stylings*/
    ::-webkit-scrollbar {
        -webkit-border-radius: 100px;
        border-radius: 100px;
        background-color: rgba(0,0,0,0);
        width: 9px;
    }
    ::-webkit-scrollbar {
        height: 16px;
        overflow: visible;
        width: 16px;
    }
    ::-webkit-scrollbar-button {
        height: 0;
        width: 0;
    }
    ::-webkit-scrollbar-corner {
        background: transparent;
    }
    .directory::-webkit-scrollbar-thumb {
        border-style: solid;
        border-color: transparent;
        border-width: 4px;
        background-color: #dadce0;
        -webkit-border-radius: 8px;
        border-radius: 8px;
        -webkit-box-shadow: none;
        box-shadow: none;
    }
    ::-webkit-scrollbar-thumb {
        border: 1px solid #f0f0f0;
    }
    ::-webkit-scrollbar-thumb {
        -webkit-border-radius: 100px;
        border-radius: 100px;
        background: rgba(0,0,0,.2);
    }
    ::-webkit-scrollbar-thumb {
        background-color: rgba(0,0,0,.2);
        background-clip: padding-box;
        border: solid transparent;
        border-width: 1px 1px 1px 6px;
        min-height: 28px;
        padding: 100px 0 0;
        -webkit-box-shadow: inset 1px 1px 0 rgb(0 0 0 / 10%), inset 0 -1px 0 rgb(0 0 0 / 7%);
        box-shadow: inset 1px 1px 0 rgb(0 0 0 / 10%), inset 0 -1px 0 rgb(0 0 0 / 7%);
    }
    ::-webkit-scrollbar-thumb:hover {
        background-color: rgb(128 134 139);
    }
    .directory::-webkit-scrollbar-track {
        -webkit-box-shadow: none;
        box-shadow: none;
        margin: 0 4px;
    }
    ::-webkit-scrollbar-track {
        background-clip: padding-box;
        border: solid transparent;
        border-width: 0 0 0 4px;
    }

    /*Directory Stylings*/
    .directory {
        width: 100%;
        border: 1px solid #e0e0e0;
    }
    .sheet-container, .bottom-row {
        border: 1px solid #e0e0e0;
    }
    .bottom-row {
        margin-top: 20px;
        margin-bottom: 40px;
    }
    .sheet-container h4, .bottom-row h4 {
        font-family: Roboto, sans-serif;
        font-weight: 100;
        margin: 0;
        padding: 7px;
    }
    .top-row {
        display: flex;
        width: 100%;
        justify-content: space-between;
    }
    #scrollable-directory {
        height: 729px;
        max-width: 100%;
        overflow: scroll;
        width: auto;
    }
    #department-directory {
        height: 729px;
        max-width: 100%;
        overflow: scroll;
    }
    table, th, td {
        text-align: center;
        font-family: 'docs-Calibri',Arial;
    }
    .left-align {
        text-align: left;
    }
    .directory.store-directory {
        width: 100%;
        height: 344px;
        overflow: scroll;
    }
    .directory.store-directory td {
        font-size: 12pt;
    }
    .directory.store-directory table {
        width: 100%;
    }
    td {
        border: 1px solid rgb(217 217 217);
        border-top: 1rem rgb(217 217 217);
        white-space: nowrap;
        font-size: 11pt;
        transition: all 0.5s;
    }
    tr {
        transition: all 0.5s;
    }
    th {
        background-color: #9900ff;
        font-weight: bolder;
        color: white;
        font-size: 14pt;
        border: 1px solid black;
        white-space: nowrap;
    }
    table {
        border-collapse: collapse;
    }

    /* @media only screen and (max-width: 600px) {
        .top-row {
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
    } */
</style>

<!-- Base HTML -->
<div id='page-cont'>
    <h1 style='text-align: center;
        font-family: Roboto, sans-serif;
        position: relative;
        border-radius: 25px;
        padding: 20px;
        box-shadow: rgb(45 35 66 / 40%) 0 2px 4px, rgb(45 35 66 / 30%) 0 7px 13px -3px, #d6d6e7 0 -3px 0 inset;'>
        Interactive Office Map
    </h1>

    <div class='switch-buttons'>
        <button id='department' class='active' onclick='handleMapSwitch(this)'>By Department</button>
        <button id='office' onclick='handleMapSwitch(this)'>By Office</button>
    </div>
    <div id='map-area'>
        <div class='inner-cont'>
            <div id='floor1' class='realtive-position'>
                <div id='floor1-department'>
                    <img id='floor1-department-img' class='base-img' src='https://i.imgur.com/3GeZ81S.png' usemap='#by-department1'>
                    <map id='by-department1' style='visibility: hidden;' name='by-department1'>
                        <area target='_self' alt='1' title='1' href='#' onclick='highlightRelevantDepartment(this)' labelText='Reception' coords='1215,334,20' shape='circle'>
                        <area target='_self' alt='2' title='2' href='#' onclick='highlightRelevantDepartment(this)' labelText='Security' coords='1127,460,1151,494' shape='rect'>
                        <area target='_self' alt='3' title='3' href='#' onclick='highlightRelevantDepartment(this)' labelText='Art Department' coords='1077,386,920,383,918,296,978,293,981,234,982,170,1120,170,1124,329,1077,328' shape='poly'>
                        <area target='_self' alt='4' title='4' href='#' labelText='Tents Storage' coords='801,423,802,166,721,164,717,227,709,230,711,284,736,283,734,378,783,382,779,424' shape='poly'>
                        <area target='_self' alt='5' title='5' href='#' labelText='Kitchen' coords='684,353,734,379' shape='rect'>
                        <area target='_self' alt='6' title='6' href='#' labelText='Samples Storage' coords='685,382,779,432' shape='rect'>
                        <area target='_self' alt='7' title='7' href='#' onclick='highlightRelevantDepartment(this)' labelText='Information Technology' coords='147,167,147,260,439,258,444,506,734,506,733,455,663,451,659,310,730,314,733,285,709,287,711,238,717,226,717,170' shape='poly'>
                        <area target='_self' alt='8' title='8' href='#' labelText='Executive Gym' coords='147,258,442,505' shape='rect'>
                        <area target='_self' alt='9' title='9' href='#' onclick='highlightRelevantDepartment(this)' labelText='Loss Prevention' coords='1123,329,1080,330,1079,379,1020,472,1019,506,1069,508,1067,470,1023,468,1077,384,1122,383' shape='poly'>
                        <area target='_self' alt='10' title='10' href='#' onclick='highlightRelevantDepartment(this)' labelText='Inventory' coords='961,410,1017,508' shape='rect'>
                        <area target='_self' alt='11' title='11' href='#' onclick='highlightRelevantDepartment(this)' labelText='Facilities' coords='806,294,857,292,859,347,907,455,907,505,841,505,839,452,907,455,860,346,808,347' shape='poly'>
                    </map>
                </div>

                <div id='floor1-office' style='display: none'>
                    <img id='floor1-office-img' class='base-img' src='https://i.imgur.com/3GeZ81S.png' usemap='#by-office1'>
                    <map id='by-office1' style='visibility: hidden;' name='by-office1'>
                        <area target='_self' alt='1' title='1' href='#' onclick='highlightName(this)' labelText='IT Annex' coords='147,165,236,208' shape='rect'>
                        <area target='_self' alt='2' title='2' href='#' onclick='highlightName(this)' labelText='0' coords='145,212,194,260' shape='rect'>
                        <area target='_self' alt='3' title='3' href='#' onclick='highlightName(this)' labelText='00' coords='200,212,231,258' shape='rect'>
                        <area target='_self' alt='4' title='4' href='#' onclick='highlightName(this)' labelText='000' coords='147,454,190,505' shape='rect'>
                        <area target='_self' alt='5' title='5' href='#' onclick='highlightName(this)' labelText='0000' coords='313,459,348,506' shape='rect'>
                        <area target='_self' alt='6' title='6' href='#' onclick='highlightName(this)' labelText='00000' coords='354,458,396,505' shape='rect'>
                        <area target='_self' alt='7' title='7' href='#' onclick='highlightName(this)' labelText='000000' coords='399,455,438,508' shape='rect'>
                        <area target='_self' alt='8' title='8' href='#' onclick='highlightName(this)' labelText='' coords='443,459,484,509' shape='rect'>
                        <area target='_self' alt='9' title='9' href='#' onclick='highlightName(this)' labelText='' coords='489,464,540,506' shape='rect'>
                        <area target='_self' alt='10' title='10' href='#' onclick='highlightName(this)' labelText='' coords='542,460,587,505' shape='rect'>
                        <area target='_self' alt='11' title='11' href='#' onclick='highlightName(this)' labelText='' coords='591,431,588,505,734,508,731,456,662,454,660,432' shape='poly'>
                        <area target='_self' alt='12' title='12' href='#' onclick='highlightName(this)' labelText='0000000' coords='734,456,788,506' shape='rect'>
                        <area target='_self' alt='13' title='13' href='#' onclick='highlightName(this)' labelText='00000000' coords='790,456,841,508' shape='rect'>
                        <area target='_self' alt='14' title='14' href='#' onclick='highlightName(this)' labelText='' coords='843,456,910,505' shape='rect'>
                        <area target='_self' alt='15' title='15' href='#' onclick='highlightName(this)' labelText='000000000' coords='909,436,964,508' shape='rect'>
                        <area target='_self' alt='16' title='16' href='#' onclick='highlightName(this)' labelText='' coords='964,411,1015,454' shape='rect'>
                        <area target='_self' alt='17' title='17' href='#' onclick='highlightName(this)' labelText='' coords='967,458,1013,505' shape='rect'>
                        <area target='_self' alt='18' title='18' href='#' onclick='highlightName(this)' labelText='' coords='1017,469,1072,508' shape='rect'>
                        <area target='_self' alt='19' title='19' href='#' onclick='highlightName(this)' labelText='' coords='1073,470,1120,508' shape='rect'>
                        <area target='_self' alt='20' title='20' href='#' onclick='highlightName(this)' labelText='' coords='1125,460,1152,494' shape='rect'>
                        <area target='_self' alt='21' title='21' href='#' onclick='highlightName(this)' labelText='' coords='1216,333,17' shape='circle'>
                        <area target='_self' alt='22' title='22' href='#' onclick='highlightName(this)' labelText='' coords='1077,330,1120,384' shape='rect'>
                        <area target='_self' alt='23' title='23' href='#' onclick='highlightName(this)' labelText='' coords='1080,278,1121,326' shape='rect'>
                        <area target='_self' alt='24' title='24' href='#' onclick='highlightName(this)' labelText='Art Meeting Room' coords='1081,225,1121,274' shape='rect'>
                        <area target='_self' alt='25' title='25' href='#' onclick='highlightName(this)' labelText='' coords='1084,171,1122,221' shape='rect'>
                        <area target='_self' alt='26' title='26' href='#' onclick='highlightName(this)' labelText='' coords='1033,167,1085,209' shape='rect'>
                        <area target='_self' alt='27' title='27' href='#' onclick='highlightName(this)' labelText='' coords='979,170,1031,233' shape='rect'>
                        <area target='_self' alt='28' title='28' href='#' onclick='highlightName(this)' labelText='' coords='979,234,1033,293' shape='rect'>
                        <area target='_self' alt='29' title='29' href='#' onclick='highlightName(this)' labelText='Art Department Conference Space' coords='919,294,1037,384' shape='rect'>
                        <area target='_self' alt='30' title='30' href='#' onclick='highlightName(this)' labelText='Mechanicals' coords='977,290,802,167' shape='rect'>
                        <area target='_self' alt='31' title='31' href='#' onclick='highlightName(this)' labelText='' coords='802,293,859,344' shape='rect'>
                        <area target='_self' alt='32' title='32' href='#' onclick='highlightName(this)' labelText='0000000000' coords='802,348,860,388' shape='rect'>
                        <area target='_self' alt='33' title='33' href='#' onclick='highlightName(this)' labelText='00000000000' coords='801,391,855,428' shape='rect'>
                        <area target='_self' alt='34' title='34' href='#' onclick='highlightName(this)' labelText='Tents Storage' coords='717,168,798,166,801,428,784,427,776,379,765,382,765,369,736,368,738,316,739,285,708,284,709,235,718,236' shape='poly'>
                        <area target='_self' alt='35' title='35' href='#' onclick='highlightName(this)' labelText='' coords='664,170,717,234' shape='rect'>
                        <area target='_self' alt='36' title='36' href='#' onclick='highlightName(this)' labelText='' coords='591,167,662,218' shape='rect'>
                        <area target='_self' alt='37' title='37' href='#' onclick='highlightName(this)' labelText='IT Storage' coords='500,166,590,207' shape='rect'>
                        <area target='_self' alt='38' title='38' href='#' onclick='highlightName(this)' labelText='IT storage' coords='470,239,362,170' shape='rect'>
                        <area target='_self' alt='39' title='39' href='#' onclick='highlightName(this)' labelText='000000000000' coords='320,167,359,238' shape='rect'>
                        <area target='_self' alt='40' title='40' href='#' onclick='highlightName(this)' labelText='0000000000000' coords='264,170,320,239' shape='rect'>
                        <area target='_self' alt='41' title='41' href='#' onclick='highlightName(this)' labelText='00000000000000' coords='259,261,302,312' shape='rect'>
                        <area target='_self' alt='42' title='42' href='#' onclick='highlightName(this)' labelText='000000000000000' coords='307,265,352,311' shape='rect'>
                        <area target='_self' alt='43' title='43' href='#' onclick='highlightName(this)' labelText='0000000000000000' coords='354,265,393,314' shape='rect'>
                        <area target='_self' alt='44' title='44' href='#' onclick='highlightName(this)' labelText='00000000000000000' coords='398,265,441,316' shape='rect'>
                        <area target='_self' alt='45' title='45' href='#' onclick='highlightName(this)' labelText='IT Conference Room' coords='587,324,660,371' shape='rect'>
                        <area target='_self' alt='46' title='46' href='#' onclick='highlightName(this)' labelText='' coords='590,370,657,429' shape='rect'>
                        <area target='_self' alt='47' title='47' href='#' onclick='highlightName(this)' labelText='IT Imaging' coords='684,235,709,283' shape='rect'>
                        <area target='_self' alt='48' title='48' href='#' onclick='highlightName(this)' labelText='Kitchen' coords='684,351,734,379' shape='rect'>
                        <area target='_self' alt='49' title='49' href='#' onclick='highlightName(this)' labelText='&quot;Samples&quot; Conference Room' coords='686,384,779,431' shape='rect'>
                        <area target='_self' alt='50' title='50' href='#' onclick='highlightName(this)' labelText='' coords='532,366,559,395' shape='rect'>
                        <area target='_self' alt='51' title='51' href='#' onclick='highlightName(this)' labelText='' coords='505,367,530,392' shape='rect'>
                        <area target='_self' alt='52' title='52' href='#' onclick='highlightName(this)' labelText='IT Help Desk' coords='471,369,495,393' shape='rect'>
                        <area target='_self' alt='53' title='53' href='#' onclick='highlightName(this)' labelText='IT Help Desk' coords='443,368,470,392' shape='rect'>
                        <area target='_self' alt='54' title='54' href='#' onclick='highlightName(this)' labelText='IT Help Desk' coords='443,396,470,424' shape='rect'>
                        <area target='_self' alt='55' title='55' href='#' onclick='highlightName(this)' labelText='IT Help Desk' coords='469,393,497,424' shape='rect'>
                        <area target='_self' alt='56' title='56' href='#' onclick='highlightName(this)' labelText='IT Help Desk' coords='501,395,528,420' shape='rect'>
                        <area target='_self' alt='57' title='57' href='#' onclick='highlightName(this)' labelText='' coords='533,396,558,420' shape='rect'>
                        <area target='_self' alt='58' title='58' href='#' onclick='highlightName(this)' labelText='Exercise space ' coords='280,342,394,422' shape='rect'>
                        <area target='_self' alt='59' title='59' href='#' onclick='highlightName(this)' labelText='Gym' coords='188,384,308,506' shape='rect'>
                    </map>
                </div>
            </div>
            <div id='floor2' class='realtive-position'>
                <div id='floor2-department'>
                    <img id='floor2-department-img' class='base-img' src='https://i.imgur.com/YIBHUHr.png' usemap='#by-department'>
                    <map id='by-department' style='visibility: hidden;' name='by-department'>
                        <area target='' alt='1' title='1' href='#' onclick='highlightRelevantDepartment(this)' labelText='Loss prevention' coords='2433,461,2528,606' shape='rect'>
                        <area target='' alt='2' title='2' href='#' onclick='highlightRelevantDepartment(this)' labelText='Advertising and Social Media' coords='2444,612,2436,778,2171,779,2169,955,2065,957,2054,685,2255,682,2250,619' shape='poly'>
                        <area target='' alt='3' title='3' href='#' onclick='highlightRelevantDepartment(this)' labelText='Customer Service' coords='2052,948,1937,946,1940,760,1867,752,1859,462,2052,457,2119,464,2116,546,2052,548,2055,752' shape='poly'>
                        <area target='' alt='4' title='4' href='#' onclick='highlightRelevantDepartment(this)' labelText='Legal' coords='1332,93,1327,251,1482,250,1492,395,1871,403,1866,92' shape='poly'>
                        <area target='' alt='5' title='5' href='#' onclick='highlightRelevantDepartment(this)' labelText='Imports' coords='1029,807,1215,947' shape='rect'>
                        <area target='' alt='6' title='6' href='#' onclick='highlightRelevantDepartment(this)' labelText='Imports' coords='838,703,1037,769' shape='rect'>
                        <area target='' alt='7' title='7' href='#' onclick='highlightRelevantDepartment(this)' labelText='Imports' coords='569,591,668,695' shape='rect'>
                        <area target='' alt='8' title='8' href='#' onclick='highlightRelevantDepartment(this)' labelText='Executive Assitant' coords='1182,598,1182,685,1215,692,1225,764,1296,761,1296,703,1365,700,1365,598' shape='poly'>
                        <area target='' alt='9' title='9' href='#' onclick='highlightRelevantDepartment(this)' labelText='Executives' coords='1942,830,1935,950,1222,952,1220,843,1296,833,1304,710,1439,700,1446,601,1515,598,1507,479,1686,463,1680,827,1874,830' shape='poly'>
                        <area target='' alt='10' title='10' href='#' onclick='highlightRelevantDepartment(this)' labelText='Executives' coords='500,812,874,947' shape='rect'>
                        <area target='' alt='11' title='11' href='#' onclick='highlightRelevantDepartment(this)' labelText='Executive Support' coords='876,807,1024,947' shape='rect'>
                        <area target='' alt='12' title='12' href='#' onclick='highlightRelevantDepartment(this)' labelText='Executive Support' coords='347,598,472,698' shape='rect'>
                        <area target='' alt='13' title='13' href='#' onclick='highlightRelevantDepartment(this)' labelText='Development' coords='34,693,146,695,154,808,340,810,350,948,37,947' shape='poly'>
                        <area target='' alt='14' title='14' href='#' onclick='highlightRelevantDepartment(this)' labelText='Purchasing' coords='34,428,149,682' shape='rect'>
                        <area target='' alt='15' title='15' href='#' onclick='highlightRelevantDepartment(this)' labelText='Chain Stores' coords='37,247,258,418' shape='rect'>
                        <area target='' alt='16' title='16' href='#' onclick='highlightRelevantDepartment(this)' labelText='Chain Stores' coords='477,384,770,535' shape='rect'>
                        <area target='' alt='17' title='17' href='#' onclick='highlightRelevantDepartment(this)' labelText='Chain Stores' coords='663,593,754,761' shape='rect'>
                        <area target='' alt='18' title='18' href='#' onclick='highlightRelevantDepartment(this)' labelText='Retail' coords='2174,825,2169,947,2866,945,2858,545,2759,550,2762,705,2675,698,2678,827' shape='poly'>
                        <area target='' alt='19' title='19' href='#' onclick='highlightRelevantDepartment(this)' labelText='Human Resources' coords='2253,461,2433,614' shape='rect'>
                        <area target='' alt='20' title='20' href='#' onclick='highlightRelevantDepartment(this)' labelText='Human Resources' coords='1037,595,1156,747' shape='rect'>
                        <area target='' alt='21' title='21' href='#' onclick='highlightRelevantDepartment(this)' labelText='Accounting &amp; Payroll' coords='645,87,648,196,752,201,787,288,787,535,846,535,841,698,1034,703,1032,591,1037,527,1413,522,1411,316,1327,321,1329,81' shape='poly'>
                        <area target='' alt='22' title='22' href='#' onclick='highlightRelevantDepartment(this)' labelText='Tents' coords='411,87,640,87,642,214,780,293,785,377,416,379' shape='poly'>
                        <area target='' alt='23' title='23' href='#' onclick='highlightRelevantDepartment(this)' labelText='Chain Stores' coords='350,815,497,947' shape='rect'>
                        <area target='' alt='24' title='24' href='#' onclick='highlightRelevantDepartment(this)' labelText='Executive Conference Room' coords='1688,463,1881,822' shape='rect'>
                        <area target='' alt='25' title='25' href='#' onclick='highlightRelevantDepartment(this)' labelText='Large Conference Room' coords='2624,244,2858,540' shape='rect'>
                        <area target='' alt='26' title='26' href='#' onclick='highlightRelevantDepartment(this)' labelText='Northern Conference Room' coords='276,87,406,303' shape='rect'>
                    </map>
                </div>
                <div id='floor2-office' style='display: none'>
                    <img id='floor2-office-img' class='base-img' src='https://i.imgur.com/YIBHUHr.png' usemap='#by-office'>
                    <map id='by-office' style='visibility: hidden;' name='by-office'>
                        <area target='_self' alt='1' title='1' href='#' onclick='highlightName(this)' labelText='' coords='34,249,151,349' shape='rect'>
                        <area target='_self' alt='2' title='2' href='#' onclick='highlightName(this)' labelText='' coords='39,341,146,418' shape='rect'>
                        <area target='_self' alt='3' title='3' href='#' onclick='highlightName(this)' labelText='' coords='37,425,141,545' shape='rect'>
                        <area target='_self' alt='4' title='4' href='#' onclick='highlightName(this)' labelText='' coords='32,545,144,680' shape='rect'>
                        <area target='_self' alt='5' title='5' href='#' onclick='highlightName(this)' labelText='000000000000000000' coords='34,691,139,818' shape='rect'>
                        <area target='_self' alt='6' title='6' href='#' onclick='highlightName(this)' labelText='' coords='149,950,34,817' shape='rect'>
                        <area target='_self' alt='7' title='7' href='#' onclick='highlightName(this)' labelText='' coords='159,814,266,952' shape='rect'>
                        <area target='_self' alt='9' title='9' href='#' onclick='highlightName(this)' labelText='' coords='268,810,342,952' shape='rect'>
                        <area target='_self' alt='10' title='10' href='#' onclick='highlightName(this)' labelText='00000000000000000000000' coords='457,878' shape='rect'>
                        <area target='_self' alt='11' title='11' href='#' onclick='highlightName(this)' labelText='' coords='345,815,497,945' shape='rect'>
                        <area target='_self' alt='12' title='12' href='#' onclick='highlightName(this)' labelText='' coords='492,812,655,952' shape='rect'>
                        <area target='_self' alt='13' title='13' href='#' onclick='highlightName(this)' labelText='' coords='696,810,876,950' shape='rect'>
                        <area target='_self' alt='14' title='14' href='#' onclick='highlightName(this)' labelText='' coords='887,807,1021,947' shape='rect'>
                        <area target='_self' alt='15' title='15' href='#' onclick='highlightName(this)' labelText='' coords='1029,810,1108,945' shape='rect'>
                        <area target='_self' alt='16' title='16' href='#' onclick='highlightName(this)' labelText='' coords='1108,809,1215,949' shape='rect'>
                        <area target='_self' alt='17' title='17' href='#' onclick='highlightName(this)' labelText='' coords='1299,708,1441,945' shape='rect'>
                        <area target='_self' alt='18' title='18' href='#' onclick='highlightName(this)' labelText='' coords='1451,945,1670,596' shape='rect'>
                        <area target='_self' alt='19' title='19' href='#' onclick='highlightName(this)' labelText='' coords='1782,830,1942,950' shape='rect'>
                        <area target='_self' alt='20' title='20' href='#' onclick='highlightName(this)' labelText='' coords='1950,835,2060,947' shape='rect'>
                        <area target='_self' alt='21' title='21' href='#' onclick='highlightName(this)' labelText='' coords='2065,827,2166,947' shape='rect'>
                        <area target='_self' alt='22' title='22' href='#' onclick='highlightName(this)' labelText='' coords='2174,833,2283,950' shape='rect'>
                        <area target='_self' alt='23' title='23' href='#' onclick='highlightName(this)' labelText='' coords='2286,830,2357,950' shape='rect'>
                        <area target='_self' alt='24' title='24' href='#' onclick='highlightName(this)' labelText='' coords='2362,827,2433,945' shape='rect'>
                        <area target='_self' alt='25' title='25' href='#' onclick='highlightName(this)' labelText='' coords='2446,825,2584,950' shape='rect'>
                        <area target='_self' alt='26' title='26' href='#' onclick='highlightName(this)' labelText='' coords='2591,833,2668,950' shape='rect'>
                        <area target='_self' alt='27' title='27' href='#' onclick='highlightName(this)' labelText='' coords='2670,947,2734,827' shape='rect'>
                        <area target='_self' alt='28' title='28' href='#' onclick='highlightName(this)' labelText='' coords='2736,812,2856,945' shape='rect'>
                        <area target='_self' alt='29' title='29' href='#' onclick='highlightName(this)' labelText='' coords='2744,672,2861,810' shape='rect'>
                        <area target='_self' alt='30' title='30' href='#' onclick='highlightName(this)' labelText='' coords='2764,550,2871,670' shape='rect'>
                        <area target='_self' alt='31' title='31' href='#' onclick='highlightName(this)' labelText='' coords='2433,607,2528,465' shape='rect'>
                        <area target='_self' alt='32' title='32' href='#' onclick='highlightName(this)' labelText='Large Conference Room' coords='2622,244,2869,542' shape='rect'>
                        <area target='_self' alt='33' title='33' href='#' onclick='highlightName(this)' labelText='' coords='2357,453,2428,616' shape='rect'>
                        <area target='_self' alt='34' title='34' href='#' onclick='highlightName(this)' labelText='' coords='2243,453,2352,616' shape='rect'>
                        <area target='_self' alt='35' title='35' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000' coords='1935,229,2060,395' shape='rect'>
                        <area target='_self' alt='36' title='36' href='#' onclick='highlightName(this)' labelText='' coords='1683,81,1869,252' shape='rect'>
                        <area target='_self' alt='37' title='37' href='#' onclick='highlightName(this)' labelText='' coords='1480,92,1670,244' shape='rect'>
                        <area target='_self' alt='39' title='39' href='#' onclick='highlightName(this)' labelText='' coords='1340,87,1477,247' shape='rect'>
                        <area target='_self' alt='40' title='40' href='#' onclick='highlightName(this)' labelText='' coords='1233,89,1327,247' shape='rect'>
                        <area target='_self' alt='41' title='41' href='#' onclick='highlightName(this)' labelText='' coords='1599,249,1719,395' shape='rect'>
                        <area target='_self' alt='42' title='42' href='#' onclick='highlightName(this)' labelText='' coords='1146,81,1230,255' shape='rect'>
                        <area target='_self' alt='43' title='43' href='#' onclick='highlightName(this)' labelText='000000000000000000000000000000000000' coords='1021,130,1136,265' shape='rect'>
                        <area target='_self' alt='45' title='45' href='#' onclick='highlightName(this)' labelText='' coords='841,94,1014,204' shape='rect'>
                        <area target='_self' alt='46' title='46' href='#' onclick='highlightName(this)' labelText='' coords='731,82,833,160' shape='rect'>
                        <area target='_self' alt='47' title='47' href='#' onclick='highlightName(this)' labelText='' coords='647,89,726,201' shape='rect'>
                        <area target='_self' alt='48' title='48' href='#' onclick='highlightName(this)' labelText='' coords='541,87,650,201' shape='rect'>
                        <area target='_self' alt='49' title='49' href='#' onclick='highlightName(this)' labelText='' coords='419,81,533,199' shape='rect'>
                        <area target='_self' alt='50' title='50' href='#' onclick='highlightName(this)' labelText='North Conference Room' coords='263,79,413,303' shape='rect'>
                        <area target='_self' alt='51' title='51' href='#' onclick='highlightName(this)' labelText='' coords='184,242,268,392' shape='rect'>
                        <area target='_self' alt='52' title='52' href='#' onclick='highlightName(this)' labelText='0000000000000000000000000000000000000' coords='184,395,263,494' shape='rect'>
                        <area target='_self' alt='53' title='53' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000000' coords='218,670,266,769' shape='rect'>
                        <area target='_self' alt='54' title='54' href='#' onclick='highlightName(this)' labelText='' coords='350,593,474,698' shape='rect'>
                        <area target='_self' alt='55' title='55' href='#' onclick='highlightName(this)' labelText='000000000000000000000000000000000000000' coords='355,705,482,769' shape='rect'>
                        <area target='_self' alt='56' title='56' href='#' onclick='highlightName(this)' labelText='' coords='569,596,668,695' shape='rect'>
                        <area target='_self' alt='57' title='57' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000000000' coords='571,700,665,761' shape='rect'>
                        <area target='_self' alt='58' title='58' href='#' onclick='highlightName(this)' labelText='' coords='675,598,757,692' shape='rect'>
                        <area target='_self' alt='59' title='59' href='#' onclick='highlightName(this)' labelText='' coords='663,705,757,759' shape='rect'>
                        <area target='_self' alt='60' title='60' href='#' onclick='highlightName(this)' labelText='' coords='836,596,940,703' shape='rect'>
                        <area target='_self' alt='61' title='61' href='#' onclick='highlightName(this)' labelText='' coords='838,710,1032,759' shape='rect'>
                        <area target='_self' alt='62' title='62' href='#' onclick='highlightName(this)' labelText='' coords='938,593,1039,703' shape='rect'>
                        <area target='_self' alt='64' title='64' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000000000000' coords='1044,601,1149,675' shape='rect'>
                        <area target='_self' alt='65' title='65' href='#' onclick='highlightName(this)' labelText='' coords='1044,677,1149,741' shape='rect'>
                        <area target='_self' alt='66' title='66' href='#' onclick='highlightName(this)' labelText='' coords='1182,593,1184,685,1217,687,1222,766,1294,766,1291,695,1370,692,1367,593' shape='poly'>
                        <area target='_self' alt='67' title='67' href='#' onclick='highlightName(this)' labelText='Executive Conference Room' coords='1678,463,1869,820' shape='rect'>
                        <area target='_self' alt='68' title='68' href='#' onclick='highlightName(this)' labelText='Legal Conference Room' coords='1482,252,1591,392' shape='rect'>
                        <area target='_self' alt='69' title='69' href='#' onclick='highlightName(this)' labelText='Legal File Room' coords='1721,255,1869,392' shape='rect'>
                        <area target='_self' alt='70' title='70' href='#' onclick='highlightName(this)' labelText='' coords='803,308,894,415' shape='rect'>
                        <area target='_self' alt='71' title='71' href='#' onclick='highlightName(this)' labelText='' coords='785,420,899,524' shape='rect'>
                        <area target='_self' alt='72' title='72' href='#' onclick='highlightName(this)' labelText='' coords='759,168,836,252' shape='rect'>
                        <area target='_self' alt='73' title='73' href='#' onclick='highlightName(this)' labelText='Customer Service (Old Art)' coords='1874,455,1973,542' shape='rect'>
                        <area target='_self' alt='74' title='74' href='#' onclick='highlightName(this)' labelText='0000000000000000000000000000000000000000000000' coords='1978,458,2049,502' shape='rect'>
                        <area target='_self' alt='75' title='75' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000000000000000' coords='1978,507,2047,547' shape='rect'>
                        <area target='_self' alt='77' title='77' href='#' onclick='highlightName(this)' labelText='0000000000000000000000000000000000000000000000000' coords='1930,593,1876,555' shape='rect'>
                        <area target='_self' alt='78' title='78' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000000000000000000' coords='1996,552,2052,598' shape='rect'>
                        <area target='_self' alt='79' title='79' href='#' onclick='highlightName(this)' labelText='000000000000000000000000000000000000000000000000000' coords='1874,598,1942,647' shape='rect'>
                        <area target='_self' alt='80' title='80' href='#' onclick='highlightName(this)' labelText='0000000000000000000000000000000000000000000000000000' coords='2049,603,1981,644' shape='rect'>
                        <area target='_self' alt='81' title='81' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000000000000000000000' coords='1874,652,1937,703' shape='rect'>
                        <area target='_self' alt='83' title='83' href='#' onclick='highlightName(this)' labelText='0000000000000000000000000000000000000000000000000000000' coords='1986,652,2047,698' shape='rect'>
                        <area target='_self' alt='84' title='84' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000000000000000000000000' coords='1869,700,1942,761' shape='rect'>
                        <area target='_self' alt='85' title='85' href='#' onclick='highlightName(this)' labelText='000000000000000000000000000000000000000000000000000000000' coords='1981,705,2049,761' shape='rect'>
                        <area target='_self' alt='86' title='86' href='#' onclick='highlightName(this)' labelText='0000000000000000000000000000000000000000000000000000000000' coords='2054,682,2159,782' shape='rect'>
                        <area target='_self' alt='87' title='87' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000000000000000000000000000' coords='2248,626,2324,695' shape='rect'>
                        <area target='_self' alt='88' title='88' href='#' onclick='highlightName(this)' labelText='000000000000000000000000000000000000000000000000000000000000' coords='2370,616,2433,700' shape='rect'>
                        <area target='_self' alt='89' title='89' href='#' onclick='highlightName(this)' labelText='0000000000000000000000000000000000000000000000000000000000000' coords='2245,705,2324,777' shape='rect'>
                        <area target='_self' alt='90' title='90' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000000000000000000000000000000' coords='2365,700,2433,777' shape='rect'>
                        <area target='_self' alt='91' title='91' href='#' onclick='highlightName(this)' labelText='000000000000000000000000000000000000000000000000000000000000000' coords='1037,390,981,331' shape='rect'>
                        <area target='_self' alt='92' title='92' href='#' onclick='highlightName(this)' labelText='0000000000000000000000000000000000000000000000000000000000000000' coords='981,405,1034,458' shape='rect'>
                        <area target='_self' alt='93' title='93' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000000000000000000000000000000000' coords='983,461,1032,519' shape='rect'>
                        <area target='_self' alt='94' title='94' href='#' onclick='highlightName(this)' labelText='' coords='1047,328,1098,390' shape='rect'>
                        <area target='_self' alt='95' title='95' href='#' onclick='highlightName(this)' labelText='' coords='1042,400,1100,458' shape='rect'>
                        <area target='_self' alt='96' title='96' href='#' onclick='highlightName(this)' labelText='000000000000000000000000000000000000000000000000000000000000000000' coords='1044,463,1098,519' shape='rect'>
                        <area target='_self' alt='97' title='97' href='#' onclick='highlightName(this)' labelText='0000000000000000000000000000000000000000000000000000000000000000000' coords='1139,326,1197,392' shape='rect'>
                        <area target='_self' alt='99' title='99' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000000000000000000000000000000000000' coords='1144,400,1192,458' shape='rect'>
                        <area target='_self' alt='100' title='100' href='#' onclick='highlightName(this)' labelText='000000000000000000000000000000000000000000000000000000000000000000000' coords='1146,466,1192,522' shape='rect'>
                        <area target='_self' alt='101' title='101' href='#' onclick='highlightName(this)' labelText='0000000000000000000000000000000000000000000000000000000000000000000000' coords='1205,326,1256,390' shape='rect'>
                        <area target='_self' alt='102' title='102' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000000000000000000000000000000000000000' coords='1207,397,1258,461' shape='rect'>
                        <area target='_self' alt='103' title='103' href='#' onclick='highlightName(this)' labelText='000000000000000000000000000000000000000000000000000000000000000000000000' coords='1200,466,1256,522' shape='rect'>
                        <area target='_self' alt='104' title='104' href='#' onclick='highlightName(this)' labelText='0000000000000000000000000000000000000000000000000000000000000000000000000' coords='1306,321,1357,387' shape='rect'>
                        <area target='_self' alt='105' title='105' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000000000000000000000000000000000000000000' coords='1301,400,1355,456' shape='rect'>
                        <area target='_self' alt='106' title='106' href='#' onclick='highlightName(this)' labelText='000000000000000000000000000000000000000000000000000000000000000000000000000' coords='1304,463,1357,522' shape='rect'>
                        <area target='_self' alt='107' title='107' href='#' onclick='highlightName(this)' labelText='0000000000000000000000000000000000000000000000000000000000000000000000000000' coords='1360,321,1423,390' shape='rect'>
                        <area target='_self' alt='108' title='108' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000000000000000000000000000000000000000000000' coords='1365,395,1418,461' shape='rect'>
                        <area target='_self' alt='109' title='109' href='#' onclick='highlightName(this)' labelText='000000000000000000000000000000000000000000000000000000000000000000000000000000' coords='1370,466,1416,522' shape='rect'>
                        <area target='_self' alt='110' title='110' href='#' onclick='highlightName(this)' labelText='Tents 1' coords='480,306,551,377' shape='rect'>
                        <area target='_self' alt='111' title='111' href='#' onclick='highlightName(this)' labelText='Tents 2' coords='558,306,625,379' shape='rect'>
                        <area target='_self' alt='112' title='112' href='#' onclick='highlightName(this)' labelText='Tents 3' coords='632,306,698,379' shape='rect'>
                        <area target='_self' alt='113' title='113' href='#' onclick='highlightName(this)' labelText='' coords='711,308,767,367' shape='rect'>
                        <area target='_self' alt='114' title='114' href='#' onclick='highlightName(this)' labelText='0000000000000000000000000000000000000000000000000000000000000000000000000000000' coords='487,384,551,458' shape='rect'>
                        <area target='_self' alt='115' title='115' href='#' onclick='highlightName(this)' labelText='' coords='564,390,620,461' shape='rect'>
                        <area target='_self' alt='116' title='116' href='#' onclick='highlightName(this)' labelText='00000000000000000000000000000000000000000000000000000000000000000000000000000000' coords='637,390,703,461' shape='rect'>
                        <area target='_self' alt='117' title='117' href='#' onclick='highlightName(this)' labelText='000000000000000000000000000000000000000000000000000000000000000000000000000000000' coords='711,397,772,458' shape='rect'>
                        <area target='_self' alt='118' title='118' href='#' onclick='highlightName(this)' labelText='' coords='487,468,561,522' shape='rect'>
                        <area target='_self' alt='119' title='119' href='#' onclick='highlightName(this)' labelText='' coords='701,468,767,524' shape='rect'>
                    </map>
                </div>
            </div>
        </div>
    </div>

    <div id='directories-cotainer'>
        <div class='top-row'>
            <div class='sheet-container'>
                <h4>Clickable Directory</h4>
                <div id='scrollable-directory' class='directory'>
                </div>
            </div>
            <div class='sheet-container'>
                <h4>Directory By Department</h4>
                <div id='department-directory' class='directory'>
                </div>
            </div>
        </div>
        <div class='bottom-row'>
            <h4>Store Directory</h4>
            <div class='store-directory directory'>
            </div>
        </div>
    </div>
</div>

<!-- ES6 Promise polyfill script. Helps older browsers understand modern code -->
<script
  type='text/javascript'
  src='https://cdn.jsdelivr.net/npm/es6-promise/dist/es6-promise.auto.min.js'
></script>

<!-- JQuery, required for Mapster -->
<script
  src='https://code.jquery.com/jquery-3.6.0.min.js'
  integrity='sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4='
  crossorigin='anonymous'></script>

<!-- Mapster. Jquery plugin that helps make the interactive map more functional -->
<script src='https://cdn.jsdelivr.net/gh/jamietre/ImageMapster@main/dist/jquery.imagemapster.min.js'></script>

<!-- Custom scripts to add functionality to page -->
<script>
    /////////////////////////// UTILITIES ///////////////////////////
    // Converts the passed string to title case
    // ex: toTitleCase('john adams') returns 'John Adams'
    function toTitleCase(str) {
        return str.replace(
            /\w\S*/g,
            function(txt) {
                return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
            }
        );
    }

    /////////////////////////// END UTILITES ///////////////////////////

    /////////////////////////// RENDERERS ///////////////////////////
    // Renders the clickable directory by making a request to the custom api and building
    // the required elements
    const renderClickableDir = async () => {
        
        // Get data from the api and parse into a JSON object
        const response = await fetch('https://fireworks-directory-api.herokuapp.com/api/extension_directory');
        const json = await response.json();

        // Create the base elements
        const table = document.createElement('table');
        const header = document.createElement('tr');
        header.innerHTML = '<th>Name</th><th>EXT.</th>'

        // Build the array of table rows
        const rowArr = [header];
        for (const key in json) {
            const row = document.createElement('tr');
            row.setAttribute('onclick', 'highlightOffice(this)');
            row.setAttribute('class', json[key].mappable ? 'clickable' : '');
            row.setAttribute('style', json[key].bold ? 'font-weight: bold' : '');
            row.id = key.toLowerCase().replaceAll(' ', '_');
            row.innerHTML = `<td>${key}</td><td>${json[key].extension}</td>`;
            rowArr.push(row);
        }

        // Append each table row to the created table
        for (let i = 0; i < rowArr.length; i++) {
            table.appendChild(rowArr[i]);
        }

        // Append table to the correct div
        document.getElementById('scrollable-directory').appendChild(table);
    }

    // Renders the directory by department by making a request to the custom api, sorting first alphabetically,
    // then by number of people in the department, then by whether their name should be bolded. Bolded names appear
    // at the top of each department
    const renderDepartmentDirectory = async () => {
        
        // Get data from the api and parse into a JSON object
        const response = await fetch('https://fireworks-directory-api.herokuapp.com/api/by_department');
        const json = await response.json();

        // Sort the departments alphabetically and then by number
        // of people in the department
        const alphabetical = Object.keys(json).sort().sort(
            (keyA, keyB) => {
                return Object.keys(json[keyB]).length - Object.keys(json[keyA]).length
            }
        ).reduce(
            (obj, key) => { 
                obj[key] = json[key]; 
                return obj;
            }, 
            {}
        );

        // Sort each department alphabetically and then by whether
        // the name should be in bold
        const keys = Object.keys(alphabetical);
        for (const index in keys) {
            const departmentObj = alphabetical[keys[index]];
            const sortedDepartmentObj = Object.keys(departmentObj).sort().sort(
                (keyA, keyB) => {
                    if (departmentObj[keyA].bold && !departmentObj[keyB].bold) return -1;
                    else if (!departmentObj[keyA].bold && departmentObj[keyB].bold) return 1;
                    else return 0;
                }
            ).reduce(
                (obj, key) => { 
                    obj[key] = departmentObj[key]; 
                    return obj;
                }, 
                {}
            );
            alphabetical[keys[index]] = sortedDepartmentObj;
        }

        // Group the keys in groups of 3 to render the table
        let tempArr = [];
        const groupedKeysArr = [];
        for (let i = 0; i < keys.length; i++) {
            if (i % 3 === 0 && i != 0) {
                groupedKeysArr.push(tempArr);
                tempArr = [];
            }
            tempArr.push(keys[i]);
        }

        // Create the table rows and populate with data
        const tableArr = [];
        groupedKeysArr.map(header => {
            const headerHTML = document.createElement('tr');
            headerHTML.innerHTML = `
                <th class=${header[0].toLowerCase().replaceAll(' ', '_').replaceAll('&', 'and').replaceAll('\'', '')}>${header[0]}</th>
                <th class=${header[1].toLowerCase().replaceAll(' ', '_').replaceAll('&', 'and').replaceAll('\'', '')}>${header[1]}</th>
                <th class=${header[2].toLowerCase().replaceAll(' ', '_').replaceAll('&', 'and').replaceAll('\'', '')}>${header[2]}</th>
            `;
            tableArr.push(headerHTML);
            const header0List = alphabetical[header[0]];
            const header1List = alphabetical[header[1]];
            const header2List = alphabetical[header[2]];
            const max = Math.max(Object.keys(header0List).length, Object.keys(header1List).length, Object.keys(header2List).length)
            for (let i = 0; i < max; i++) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class='${header[0].toLowerCase().replaceAll(' ', '_').replaceAll('&', 'and').replaceAll('\'', '')}' 
                    style='${header0List[Object.keys(header0List)[i]]?.bold ? 'font-weight: bold' : ''}'>${Object.keys(header0List)[i] ? 
                        header0List[Object.keys(header0List)[i]].extension + ' - ' + Object.keys(header0List)[i] : ''}</td>
                    <td class='${header[1].toLowerCase().replaceAll(' ', '_').replaceAll('&', 'and').replaceAll('\'', '')}' 
                    style='${header1List[Object.keys(header1List)[i]]?.bold ? 'font-weight: bold' : ''}'>${Object.keys(header1List)[i] ? 
                        header1List[Object.keys(header1List)[i]].extension + ' - ' + Object.keys(header1List)[i] : ''}</td>
                    <td class='${header[2].toLowerCase().replaceAll(' ', '_').replaceAll('&', 'and').replaceAll('\'', '')}' 
                    style='${header2List[Object.keys(header2List)[i]]?.bold ? 'font-weight: bold' : ''}'>${Object.keys(header2List)[i] ? 
                        header2List[Object.keys(header2List)[i]].extension + ' - ' + Object.keys(header2List)[i] : ''}</td>
                `;
                tableArr.push(row);
            }
        });

        // Create the table element and append the rows
        const table = document.createElement('table');
        for (let i = 0; i < tableArr.length; i++) {
            table.appendChild(tableArr[i]);
        }

        // Append the table to the proper div
        document.getElementById('department-directory').appendChild(table);
    }

    // Renders the showroom directory by making a request to the custom api and building the
    // required elements
    const renderShowroomDir = async () => {
        
        // Get data from the api and parse into a JSON object
        const response = await fetch('https://fireworks-directory-api.herokuapp.com/api/store_directory');
        const json = await response.json();

        // Create base elements
        const table = document.createElement('table');
        const header = document.createElement('tr');
        header.innerHTML = '<th>Showroom</th><th>Address</th><th>City</th><th>State</th><th>Zip</th><th>Phone</th>'

        // Create the rows populated with data and push onto the array
        const rowArr = [header];
        for (const key in json) {
            const row = document.createElement('tr');
            row.innerHTML = `
                            <td class='left-align'>${key}</td>
                            <td>${json[key].address}</td>
                            <td>${json[key].city}</td>
                            <td>${json[key].state}</td>
                            <td>${json[key].zip}</td>
                            <td>${json[key].phone}</td>
                            `;
            rowArr.push(row);
        }

        // Append each row to the table element
        for (let i = 0; i < rowArr.length; i++) {
            table.appendChild(rowArr[i]);
        }

        // Append the table to the proper div
        document.querySelector('.store-directory.directory').appendChild(table);
    }

    // Assigns names to each of the offices by first determining the floor they are on and thus which map area to choose
    // and changing the labelText attribute of the element
    const assignOffices = async () => {
        
        // Get data from the api and parse into a JSON object
        const response = await fetch('https://fireworks-directory-api.herokuapp.com/api/office_mapping');
        const json = await response.json();

        // Find the proper map, select the correct map area, and change the labelText attribute
        // The autoAssigned attribute is used simply for tracking which names were automatically
        // labeled by this script
        for (const key in json) {
            const map = document.getElementById(`by-office${json[key].floor === '1' ? '1' : ''}`);
            map.querySelector(`area[title='${json[key].office}']`).setAttribute('labelText', toTitleCase(key));
            map.querySelector(`area[title='${json[key].office}']`).setAttribute('autoAssigned', true);
        }
    }

    /////////////////////////// END RENDERERS ///////////////////////////

    /////////////////////////// CALCULATION FUNCS ///////////////////////////

    // Credit to 'https://www.456bereastreet.com/archive/201104/how_to_find_the_center_of_an_area_element_with_javascript/'
    // Gets the center of a map area, modified to return max and min heights to better assign the 
    // coordinates of the popup text
    function getAreaCenter(shape, coords) {
        var coordsArray = coords.split(','),
            center = [];
        if (shape == 'circle') {
            // For circle areas the center is given by the first two values
            center = [parseInt(coordsArray[0]), parseInt(coordsArray[1]), parseInt(coordsArray[1]) - parseInt(coordsArray[2]), parseInt(coordsArray[1]) - parseInt(coordsArray[2])];
        } else {
            // For rect and poly areas we need to loop through the coordinates
            var coord,
                minX = maxX = parseInt(coordsArray[0], 10),
                minY = maxY = parseInt(coordsArray[1], 10);
            for (var i = 0, l = coordsArray.length; i < l; i++) {
                coord = parseInt(coordsArray[i], 10);
                if (i%2 == 0) { // Even values are X coordinates
                    if (coord < minX) {
                        minX = coord;
                    } else if (coord > maxX) {
                        maxX = coord;
                    }
                } else { // Odd values are Y coordinates
                    if (coord < minY) {
                        minY = coord;
                    } else if (coord > maxY) {
                        maxY = coord;
                    }
                }
            }
            center = [parseInt((minX + maxX) / 2, 10), parseInt((minY + maxY) / 2, 10), parseInt(minY, 10), parseInt(maxY, 10)];
        }
        return(center);
    };

    // Calculates the css 'left' style required for the popup text
    const calculateLeftVal = (el, centerX) => {
        const width = el.offsetWidth;
        const halfWidth = width / 2;
        if (centerX - halfWidth < 0) {
            return Math.abs(halfWidth + (centerX / 2));
        }
        else if (centerX + halfWidth > el.parentElement.offsetWidth) {
            return (centerX - Math.abs(centerX + halfWidth - el.parentElement.offsetWidth))
        }
        return centerX;
    }

    /////////////////////////// END CALCULATION FUNCS ///////////////////////////

    /////////////////////////// RESPONSIVENESS ///////////////////////////
    var resizeTime = 0; // Animation time for resize, set to 0 for instantaneous
    var resizeDelay = 50; // How long to wait between window resize events to resize the image

    // Resize each of the images and maps to fit within the correct space
    function resize(maxWidth,maxHeight) {
        var image1 = $('#floor1-department-img'),
            image2 = $('#floor2-department-img'),
            image3 = $('#floor1-office-img'),
            image4 = $('#floor2-office-img'),
            imgWidth1 = image1.width(),
            imgHeight1 = image1.height(),
            imgWidth2 = image2.width(),
            imgHeight2 = image2.height(),
            imgWidth3 = image3.width(),
            imgHeight3 = image3.height(),
            imgWidth4 = image4.width(),
            imgHeight4 = image4.height(),
            newWidth1=0,
            newHeight1=0,
            newWidth2=0,
            newHeight2=0,
            newWidth3=0,
            newHeight3=0,
            newWidth4=0,
            newHeight4=0;

        const maxWidth1 = $(image1).parent().parent().parent().width();
        const maxHeight1 = $(image1).parent().parent().parent().height();
        const maxWidth2 = $(image2).parent().parent().parent().width();
        const maxHeight2 = $(image2).parent().parent().parent().height();

        if (imgWidth1/maxWidth1>imgHeight1/maxHeight1) {
            newWidth1 = maxWidth1;
        } else {
            newHeight1 = maxHeight1;
        }

        if (imgWidth2/maxWidth2>imgHeight2/maxHeight2) {
            newWidth2 = maxWidth2;
        } else {
            newHeight2 = maxHeight2;
        }

        if (imgWidth3/maxWidth1>imgHeight3/maxHeight1) {
            newWidth3 = maxWidth1;
        } else {
            newHeight3 = maxHeight1;
        }

        if (imgWidth4/maxWidth2>imgHeight4/maxHeight2) {
            newWidth4 = maxWidth2;
        } else {
            newHeight4 = maxHeight2;
        }

        image1.mapster('resize',newWidth1,newHeight1,resizeTime);   
        image2.mapster('resize',newWidth2,newHeight2,resizeTime); 
        image3.mapster('resize',newWidth3,newHeight3,resizeTime);   
        image4.mapster('resize',newWidth4,newHeight4,resizeTime);    
    }

    // Track window resizing events, but only actually call the map resize when the
    // window isn't being resized any more
    function onWindowResize() {
        var curWidth = $(window).width(),
            curHeight = $(window).height(),
            checking=false;
        if (checking) {
            return;
                }
        checking = true;
        window.setTimeout(function() {
            var newWidth = $(window).width(),
            newHeight = $(window).height();
            if (newWidth === curWidth &&
                newHeight === curHeight) {
                resize(newWidth,newHeight); 
            }
            checking=false;
        }, resizeDelay);
    }

    $(window).bind('resize',onWindowResize);

    /////////////////////////// END RESPONSIVENESS ///////////////////////////

    /////////////////////////// FUNCTIONALITY ///////////////////////////

    // Initialize vars
    let liveSpan; // For tracking which text is currently displayed on the map
    let clicked = false; // For tracking whether an element was clicked to highlight a specific area
                         // this is then used to determine whether to actually highlight on mouseover
                         // or wait for the highlight event triggered to run its course

    // Handle switching which map is currently being used
    const handleMapSwitch = el => {
        const thisId = el.id;
        const otherButtonId = thisId === 'department' ? 'office' : 'department';

        if (!el.classList.contains('active')) el.classList.add('active');
        document.getElementById(otherButtonId).classList.remove('active');
        $(`#floor1-${thisId}`).show();
        $(`#floor2-${thisId}`).show();
        $(`#floor1-${otherButtonId}`).hide();
        $(`#floor2-${otherButtonId}`).hide();

        // Run twice because the first resize is sometimes incorrect, but second is always correct
        onWindowResize();
        onWindowResize();
    };

    // Onclick function to handle highlighting the relavant department in the by department
    // directory
    const highlightRelevantDepartment = el => {
        let departmentEls;
        let labelText = el.getAttribute('labelText').toLowerCase().replaceAll(' ', '_').replaceAll('&', 'and').replaceAll('\'', '');

        // Handle exceptions to department labels
        if (labelText.search('executive') !== -1) {
            labelText = 'executive_offices';
        }
        else if (labelText.search('purchasing') !== -1 || labelText.search('facilities') !== -1) {
            labelText = 'office_services';
        }
        else if (labelText.search('import') !== -1) {
            labelText = 'importing_and_products';
        }
        else if (labelText.search('accounting') !== -1) {
            labelText = 'accounting';
        }
        else if (labelText.search('legal') !== -1) {
            labelText = 'legal_department';
        }
        else if (labelText.search('retail') !== -1) {
            labelText = 'showroom_management';
        }
        else if (labelText.search('tent') !== -1) {
            labelText = 'tent_operations';
        }
        departmentEls = document.querySelectorAll('.' + labelText + ':not(th)');
        if (labelText.search('advertising') !== -1) {
            departmentEls = [...document.querySelectorAll('.advertising:not(th)')];
            const additionalEls = [...document.querySelectorAll('.digital_marketing_and_social_media:not(th)')]
            departmentEls = departmentEls.concat(additionalEls);
        }
        
        // Find the table rows in the by department table to highlight, scroll into view, and highlight with yellow for 2 seconds
        for (let i = 0; i < departmentEls.length; ++i) {
            if(i === 0) departmentEls[i].scrollIntoView({behavior: 'smooth', block: 'center', inline: 'center'});
            departmentEls[i].style.transition = 'all 0.25s ease-in-out';
            departmentEls[i].style.backgroundColor = 'yellow';
            setTimeout(() => {
                departmentEls[i].style.backgroundColor = 'white';
            }, 2000);
            setTimeout(() => {
                departmentEls[i].style.transition = '';
            }, 2500);
        }
        return;
    };

    // Onclick function to handle highlighting the targeted name when a specific office is clicked
    const highlightName = el => {
        
        // Convert labelText into the assumed ID
        let labelText = el.getAttribute('labelText').toLowerCase().replaceAll(' ', '_');

        // If the labelText isn't an empty string (unassigned or unknown office)
        // Then scroll into view and highlight on the clickable directory
        if (labelText !== '') {
            const nameEl = document.getElementById(labelText);
            if (nameEl) {
                nameEl.scrollIntoView({behavior: 'smooth', block: 'center', inline: 'center'});
                nameEl.style.transition = 'all 0.25s ease-in-out';
                nameEl.style.backgroundColor = 'yellow';
                setTimeout(() => {
                    nameEl.style.backgroundColor = 'white';
                }, 2000);
                setTimeout(() => {
                    nameEl.style.transition = '';
                }, 2500);
            }
        }
    }

    // Onclick function to handle highlighting the targeted office when a name in the clickable
    // directory is clicked
    const highlightOffice = el => {

        // Convert the element's ID into title case
        const name = toTitleCase(el.id.replaceAll('_', ' '));

        // Switch the map to the office map
        handleMapSwitch(document.getElementById('office'));

        // Select the area
        const area = $(`area[labelText='${name}']`);
        const scrollElement = area.parent().parent().attr('id');

        // Trigger the mouseover event and then trigger the mouseout event after 2 seconds
        // This highlights the map area
        setTimeout(() => {
            area.trigger('mouseover');
            clicked = true;
            area.mapster('set', false).mapster('set', true);
            document.getElementById(scrollElement).scrollIntoView({behavior: 'smooth', block: 'center', inline: 'center'});
        }, 50)
        setTimeout(() => {
            clicked = false;
            area.trigger('mouseout');
            area.mapster('set', false);
            if(liveSpan !== '' && liveSpan) liveSpan.remove();
        }, 2050);
    }

    /////////////////////////// END FUNCTIONALITY ///////////////////////////

    // Function required as an href attribute in each of the map areas
    // This is to deal with some of the weirdness that comes with embedding a script
    // on Google Pages. Does nothing, but makes sure no new page is opened
    const doNothing = () => {
        return;
    };

    /////////////////////////// INITALIZATION ///////////////////////////

    // Function to initialize the page by rendering all the components and starting Mapster
    const initialize = async () => {

        // Run renderers
        renderClickableDir();
        renderDepartmentDirectory();
        renderShowroomDir();

        // Wait until assignOffices is finished to initialize mapster
        await assignOffices();

        // Initialize mapster
        $('img').mapster({
            mapKey: 'labelText',
            stroke: true,
            fillColor: 'ffffff',
            strokeWidth: 3,
            strokeOpacity: 0.7,
            strokeColor: '000000',
            fillOpacity : 0.5,
            onMouseover: function(e) {
                if (!clicked) {
                    $(this).mapster('set',false).mapster('set',true);
                    const centerArr = getAreaCenter($(this).attr('shape'), $(this).attr('coords'));
                    const text = document.createElement('span');
                    text.innerText = $(this).attr('labelText').search('0') !== -1 || !$(this).attr('labelText') ?  $(this).attr('title') : $(this).attr('labelText');
                    text.className = 'hover-text';
                    $(this).parent().parent().append(text);

                    // Calculate twice since first calculation is sometimes off, but second is always correct
                    text.style['left'] = String(calculateLeftVal(text, centerArr[0]) + 'px');
                    text.style['left'] = String(calculateLeftVal(text, centerArr[0]) + 'px');

                    text.style['top'] = String(centerArr[2] - text.offsetHeight - 40 > 0 ? centerArr[2] - 40 + 'px' : centerArr[3] + 40 + 'px');
                    liveSpan = text;
                }
            },
            onMouseout: function(e) { 
                if (!clicked) {
                    $(this).mapster('set',false);
                    if (liveSpan != '')
                        liveSpan?.remove();
                    liveSpan = '';
                }
            }
        });
    }

    // Run initialize on window load
    window.onload = initialize;

    /////////////////////////// END INITIALIZATION ///////////////////////////
</script>